<!DOCTYPE html>
<html lang="he" itemscope="" itemtype="http://schema.org/Blog" ng-app="phpg">
<head>
<base href="https://phpguide.co.il/">
<meta charset="utf-8">
<meta name="description" content="שאלה מחרוזת אקראית שלא נמצאת בשימוש">
<meta name="keywords" content="שאלה, עזרה">
<meta name="author" content="yossi787">
<link rel="shortcut icon" href="..\static\images\favicon-1.ico">
<!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="..\static\styles\allstyles.compiled.css">
<title>מחרוזת אקראית שלא נמצאת בשימוש | שאלת לימוד PHP</title>
<meta itemprop="name" content="מחרוזת אקראית שלא נמצאת בשימוש | שאלת לימוד PHP">
<meta itemprop="description" content="שאלה מחרוזת אקראית שלא נמצאת בשימוש">
</head>
<body dir='rtl' class="forum-qna">
<div class='page-container'>
<section id='header'>
<div class="topRowHolder">
<a class="logo" href="..\index-3.htm"><img src="..\static\images\logo.jpg"></a>
<nav class="main">
<ul>
<li><a href="..\index-3.htm">פוסטים</a></li>
<li><a href="..\qna-1.htm" class="active">פורום</a></li>
</ul>
<div class="clear"></div>
</nav> <div class="clear"></div>
</div>
</section>  
<div class="layout-holder">
<section id="content">
<div class="qna_view_question" id="qnaQuestionHolder">
<div class="qna-home-row">
<div class="counts">
 
<div class="status  answered">
<div class="item-count">15</div>
<div>
תגובות
</div>
</div>
</div>
<div class="question-summary-wrapper">
<h2><a href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm" title="אני צריך למצוא מחרוזת כדי שתשמש בתור ID לתמונה, בשביל אתר העלאת תמונות, כדי שלא יווצר מצב אף פעם שתמונה תחליף אחרת, אני צריך גם לבדוק במסד אם ה-ID קיים, אני יכול לעשו את הבדיקה 2 או 3 פעמים אבל גם אז לא יהי מובטח שיהיה אותו ID, יש למישהו רעיון איך אני יכול להמשיך לבדוק עד שיהיה 100% שה-ID לא קיים?תודה.אגב- יש לי כבר קוד למחרוזת רק העניין שזה ימשיך לבדוק עד שזה יהיה פנוי.-----------עבדתי על זה עוד קצת זמן, הקוד הזה תקין?fo">מחרוזת אקראית שלא נמצאת בשימוש</a></h2>
<div class="userinfo">
פתח
<a>yossi787</a>
,
<time class="timeago relativetime" datetime="2014-06-24T11:15:20+03:00" style="display:inline-block;">
24 ליוני 2014 </time>
</div>
</div>
</div> <div class="clear"></div>
<div style="border-top:1px dashed #D1D1D1; margin-top:10px; padding-top:10px; " class="qnapost" id='questionText1941'>
אני צריך למצוא מחרוזת כדי שתשמש בתור ID לתמונה, בשביל אתר העלאת תמונות, כדי שלא יווצר מצב אף פעם שתמונה תחליף אחרת, אני צריך גם לבדוק במסד אם ה-ID קיים, אני יכול לעשו את הבדיקה 2 או 3 פעמים אבל גם אז לא יהי מובטח שיהיה אותו ID, יש למישהו רעיון איך אני יכול להמשיך לבדוק עד שיהיה 100% שה-ID לא קיים?<br>תודה.<br>אגב- יש לי כבר קוד למחרוזת רק העניין שזה ימשיך לבדוק עד שזה יהיה פנוי.<br>-----------<br>עבדתי על זה עוד קצת זמן, הקוד הזה תקין?<br><div class="php codeblock"><span class="kw1">for</span><span class="br0">&#40;</span><span class="re0">$ID</span> <span class="sy0">=</span> generateRandomString<span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="kw3">mysql_num_rows</span><span class="br0">&#40;</span><span class="kw3">mysql_query</span><span class="br0">&#40;</span><span class="st0">&quot;SELECT `ID` FROM `Posts` WHERE `ID`='<span class="es4">$ID</span>'&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="nu0">0</span><span class="sy0">;</span> <span class="re0">$ID</span> <span class="sy0">=</span> generateRandomString<span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="sy0">;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><br>
&nbsp; &nbsp; <span class="br0">&#125;</span></div> </div>
</div>
<h3>
<span id="answersCounter">15 </span>
תשובות
</h3>
<section class="answers" id="qnaAnswers">
<div class="answer" id="answer8777">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8777" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8777">#</a>
</span>
<div class="clear"></div>
</div>
<p>
מאוד לא מומלץ לבצע בדיקה מהסוג הזה מול מסד נתונים משום שכל פעם הוא יעבור מחדש על כל השורות ברגע שלא קיים ה id הזה.<br>ויש כמובן גם את המקרים שהוא כן ימצא ואז תצטרך להריץ יותר משאילתה אחת.<br>אז נכון בהתחלה הוא עושה את זה מהר כי יש רק כמה אלפי קבצים אך מה קורה ברגע שיהיו קיימים מיליונים או עשרות מיליונים ?<br><br>עדיף לבדוק אם הקובץ קיים במקום בו אתה שומר את הקבצים בצורה הזאת - <br><br><div class="php codeblock"><span class="kw1">do</span><span class="br0">&#123;</span><br>
&nbsp; &nbsp; <span class="re0">$file_name</span> <span class="sy0">=</span> generateRandomString<span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="st_h">'.'</span><span class="sy0">.</span><span class="re0">$ext</span><span class="sy0">;</span><br>
<span class="br0">&#125;</span><span class="kw1">while</span><span class="br0">&#40;</span><span class="kw3">file_exists</span><span class="br0">&#40;</span><span class="st_h">'my_files_path/'</span><span class="sy0">.</span><span class="re0">$file_name</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></div><br><br>שים לב שבמקרה הזה הכנסתי את ext לשם אני ממליץ לך בכללי להוסיף את זה לכתובת ככה שלדוגמא הכתובת שלך תהפוך מ <br><br>my_site.com/*key*<br>ל<br>my_site.com/*key*.jpeg<br><br>ואז בעצם יווצר מצב שאם כבר קיים ה key הזה הוא יתאפשר במידה והם לא חולקים את אותה סיומת. </p>
</div>
<div class="answer" id="answer8778">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8778" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8778">#</a>
</span>
<div class="clear"></div>
</div>
<p>
תודה רבה, יש לי עוד שאלה, אבל לא קשורה לנושא, אם אני רוצה שהקבצים ימחקו כל X שעות / שניות, איך אני יכול לקבוע שזה יקרה באופן קבוע, גם שאני / המשתמש לא באתר? </p>
</div>
<div class="answer" id="answer8779">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8779" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8779">#</a>
</span>
<div class="clear"></div>
</div>
<p>
בעזרת cron job,תיצור בדיקה שרצה על כל הקבצים בתיקיה X ותבדוק מתי הם עודכנו לאחרונה\נוצרו במידה והתאריך גדול מהזמן שהגדרת -&gt; תמחק את הקובץ.<br><br>שים לב שבמידה ומדובר בהרבה קבצים זה יכול להגיע למצב שיקח לו זמן לבצע את הפעולה ויכול להיות מצב שעדיף יהיה לך לבצע את זה באמצעות שפה עילית [בהנחה שיש לך vps\שרת] </p>
</div>
<div class="answer" id="answer8780">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8780" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8780">#</a>
</span>
<div class="clear"></div>
</div>
<p>
הבעיה היא שזה לא זמן מוגדר לכל הקבצים, אלא המשתמש בוחר תוך כמה זמן זה ימחק, אפשר עם ה-cron job להריץ קובץ PHP כל כמה זמן (שהוא בעצם ישווה בין הזמן למחיקה והזמן העכשווי וימחק את זה לבד)? </p>
</div>
<div class="answer" id="answer8781">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8781" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8781">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אתה יכול לשמור ב DB את התאריך שבו הקובץ אמור להימחק וב cron job לבדוק אם התאריך כרגע גדול מהתאריך שבו הוא אמור להימחק -&gt; מחק את השורה במסד + מהשרת. </p>
</div>
<div class="answer" id="answer8782">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8782" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8782">#</a>
</span>
<div class="clear"></div>
</div>
<p>
נתקלתי בבעיה די מוזרה: כשאני מפעיל את הקובץ, הכל עובד וכו&apos; שצריך, התמונה מוחלפת (אני מעדיף שזה יהפוך לריבוע ריק מאשר ימחק) ובמסד זה מתעדכן, אבל משום מה כשזה מופעל ב-cron job, המסד מתעדכן אבל התמונה לא נמחקת, אתה אולי יודע מה עלול להיות מקור הבעיה? </p>
</div>
<div class="answer" id="answer8783">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8783" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8783">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אם אתה לא רוצה שזה באמת ימחק מהשרת ,אין צורך לעדכן את הנתונים במסד,פשוט בשליפה של הקובץ תשלוף גם תאריך מחיקה ועם התאריך עבר אז תציג את התמונה שאתה רוצה. </p>
</div>
<div class="answer" id="answer8784">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8784" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8784">#</a>
</span>
<div class="clear"></div>
</div>
<p>
יש מצב שלא הבנתי אותך נכון, אבל אני רוצה להציג את זה באתרים אחרים (פורומים וכדומה), בגלל זה כל הסיבוך. </p>
</div>
<div class="answer" id="answer8787">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 24 ליוני 2014 </span>
<a id="answer_8787" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8787">#</a>
</span>
<div class="clear"></div>
</div>
<p>
זה לא בעיה ,תיצור נתיב מזויף באמצעות htaccess [apache?] ובעזרת php תשלח header של תמונה,עכשיו אם התמונה אמורה להימחק מהשרת -&gt; תציג את התמונה בתור התמונה שאתה רוצה,אחרת -&gt; תציג את התמונה המקורית </p>
</div>
<div class="answer" id="answer8788">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8788" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8788">#</a>
</span>
<div class="clear"></div>
</div>
<p>
תודה זה עובד.. אבל עכשיו בעיה שלא נראה לי שיש לה פיתרון- יש אפשרות לשים תמונה כזאת בפייסבוק (בסטטוס) בלי להעלות אותה לשם, זאת אומרת שעדיין תשאר שליטה על התמונה (לאחר ההעלאה הפייסבוק מעלה את זה לשרת שלו, ואז אין לי כלום מה לעשות). </p>
</div>
<div class="answer" id="answer8789">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8789" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8789">#</a>
</span>
<div class="clear"></div>
</div>
<p>
הייתי ממליץ לא ללכת על לולאה כלשהי למציאת מחרוזת רנדומלית, בגלל שזו פעולה שיכולה לקחת הרבה מאוד זמן והמון משאבים, באיחוד אם יעלו הרבה תמונות.<br>במקום זה, הייתי הולך על יצירת מחרוזת רנדומלית שהיא בוודאות לא בשימוש, למשל בצורה הבאה:<br><div class="php codeblock"><span class="re0">$name</span> <span class="sy0">=</span> <span class="kw3">rand</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="kw3">microtime</span><span class="br0">&#40;</span><span class="kw4">true</span><span class="br0">&#41;</span><span class="sy0">;</span></div><br>אם לא קריטי לך שהעורך של הנתיב יהיה תמיד 10 תווים - זו דרך שתחסוך לשרת את המשאבים. </p>
</div>
<div class="answer" id="answer8791">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8791" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8791">#</a>
</span>
<div class="clear"></div>
</div>
<p>
ענית לעצמך על התשובה,פייסבוק מעלה את התמונות לשרת שלו על מנת שהוא לא יסתמך על השרת שלך.<br>גם מבחינת מהירות [לא נראה טוב שפתאום לתמונה לוקח כמה שניות] וגם מהבחינה שאתה שולט על התוכן של התמונה,אתה יכול לדאוג שמשתמשים ממדינה X יראו תמונה פורנוגרפית ומשתמשים ממדינה Y יראו תמונה אחרת לגמרי. </p>
</div>
<div class="answer" id="answer8792">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8792" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8792">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אלכס, תודה :)<br>ו-Splash תהיה בטוח שאלו לא הכוונות שלי &gt;&lt; </p>
</div>
<div class="answer" id="answer8793">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/f032a456f986ab5afe0da9fd5706f3c3?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>Splash</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8793" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8793">#</a>
</span>
<div class="clear"></div>
</div>
<p>
זה לא משנה מה הכוונות שלך הם לא רוצים לתת לך להתעסק להם עם התמונות,אם אתה רוצה למחוק את התמונה הם נותנים לך את האפשרות באמצעות ה API שלהם וגם באמצעות האתר שלהם.<br><br>אני לא יודע כמה זה יעזור לך אבל אתה מוזמן לקרוא כאן - <br>https://developers.facebook.com/docs/graph-api/reference/v2.0/photo<br><br>שים לב שעל מנת למחוק תמונה מפייסבוק היא צריכה להתפרסם ע&quot;י האפליקציה שלך ובנוסף גם לפרסום וגם למחיקה נדרש publish_actions שלא כזה פשוט לקבל ההרשאה הזאת ופייסבוק תצטרך הוכחה ממשית לחשיבות של הפעולה ורק אם הם יראו לנכון הם יאשרו לך.<br><br>ספק מאוד גדול שהם יתנו לך למטרה הזאת ובנוסף ממש פשוט לעקוף את העניין ופשוט להוריד את התמונה למחשב ולהעלות אותה לפייסבוק בצורה רגילה. </p>
</div>
<div class="answer" id="answer8794">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/a1dfe7b93101a49b740e428c78d9b829?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>yossi787</a>
ב
<span style="font-size:10px"> 25 ליוני 2014 </span>
<a id="answer_8794" href="מחרוזת אקראית שלא נמצאת בשימוש-1.htm#answer_8794">#</a>
</span>
<div class="clear"></div>
</div>
<p>
תודה, כבר ירדתי מהרעיון הזה.. </p>
</div>
</section>
</section>  
<section id="sidebar">
<section id="search_box">
<form method="get" action="http://www.google.co.il/search" id="search_form">
<input type="hidden" name="hl" value="iw">
<input type="checkbox" name="sitesearch" style="display:none" value="https://phpguide.co.il" checked="">
<input type="text" class="search_form" placeholder="חיפוש" name="q" id="search_field">
<input type="submit" value="" title="לחפש">
</form>
</section>
<style>.staticSidebarPageLinks a{color:#e85a2d;font-weight:bold;text-decoration:underline}</style>
<div class='rblock staticSidebarPageLinks' style="padding:0 -50px; width:100%; background: white;">
<a href="page_mvcebook.html" title="למד איך עובד MVC" onclick="Analytics.track('Promotion', 'click', 'GoToLanding', 'mvcebook-sidebar-banner1');">
ספר חינם על MVC
</a>
שאתה הולך להוריד כי אם אתה רוצה ללמוד על ארגון קוד יעיל ומודרני באתרים כמו זה או פייסבוק או כי כולם אוהבים להוריד דברים איכותיים בחינם מהאינטרנט
<br><br>
<a href='page_oopbook.html'>
ספר הלימוד - תכנות מונחה עצמים מאפס
</a>
שסוף סוף ילמד אותך פיתוח מונחה עצמים נכון בצורה פשוטה, יענה על כל השאלות ויכין אותך לרעיונות עבודה.
<br><br>
<a href='page_phpunit.html'>
קורס בדיקות יחידה phpunit
</a>
שיעזור לך להקטין בחצי את כמות הבאגים, את כאב הראש והזמן המבוזבז על פתירתם
<br><br>
<a href='page_mysqlinteractive.html'>
קורס mysql אינטרקטיבי
</a>
שיייקח אותך צעד אחר צעד למומחה שאילתות mysql לייב
<br><br><br>
<small>האתר ב-readonly
<br>
תודה לכל מי שתרם, ענה, שאל, כתב, לימד ועזר במשך השנים <br>
orelbey, splash, raslin, cayce, iiddaannyy, michael, kingyes, ilikeme, itamarhadad, iosolidar, jbstyle<br>
- alex@הדומיין הזה
</small>
</div>
</section>
</div>
<footer id='footer'>
</footer>
</div>  
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-resource.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-cookies.min.js"></script>
<script type="text/javascript" src="..\assets\c2224fc8\jquery.min.js"></script>
<script type="text/javascript" src="..\static\scripts\scripts.compiled.js"></script>
<script type="text/javascript" src="..\static\scripts\plugins.js"></script>
<script type="text/javascript" src="..\static\scripts\ui.js"></script>
<script type="text/javascript" src="..\static\scripts\analytics.js"></script>
</body>
</html>
