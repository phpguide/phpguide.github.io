<!DOCTYPE html>
<html lang="he" itemscope="" itemtype="http://schema.org/Blog" ng-app="phpg">
<head>
<base href="http://phpguide.co.il/">
<meta charset="utf-8">
<meta name="description" content="שאלה שמירת קובץ עם Header מותאם אישית ב-PHP">
<meta name="keywords" content="שאלה, עזרה">
<meta name="author" content="zacharya">
<link rel="shortcut icon" href="..\static\images\favicon.ico">
<!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="..\static\styles\A.allstyles.compiled.css.pagespeed.cf.P4R8BwzxFu.css">
<title>שמירת קובץ עם Header מותאם אישית ב-PHP | שאלת לימוד PHP</title>
<meta itemprop="name" content="שמירת קובץ עם Header מותאם אישית ב-PHP | שאלת לימוד PHP">
<meta itemprop="description" content="שאלה שמירת קובץ עם Header מותאם אישית ב-PHP">
</head>
<body dir='rtl' class="forum-qna">
<div class='page-container'>
<section id='header'>
<div class="topRowHolder">
<a class="logo" href="..\index.htm"><img src="..\static\images\xlogo.jpg.pagespeed.ic.6YgiLES4FJ.jpg"></a>
<nav class="main">
<ul>
<li><a href="..\index.htm">פוסטים</a></li>
<li><a href="..\qna.htm" class="active">פורום</a></li>
</ul>
<div class="clear"></div>
</nav> <div class="clear"></div>
</div>
</section>  
<div class="layout-holder">
<section id="content">
<div class="qna_view_question" id="qnaQuestionHolder">
<div class="qna-home-row">
<div class="counts">
 
<div class="status  answered">
<div class="item-count">11</div>
<div>
תגובות
</div>
</div>
</div>
<div class="question-summary-wrapper">
<h2><a href="שמירת קובץ עם Header מותאם אישית בPHP.htm" title="יש לי קובץ PHP עם הקוד הבא:&amp;lt;?php
header&amp;#40;&amp;quot;Content-type: application/vnd.ms-word&amp;quot;&amp;#41;;
header&amp;#40;&amp;quot;Content-Disposition: attachment;Filename=document_name.doc&amp;quot;&amp;#41;">שמירת קובץ עם Header מותאם אישית ב-PHP</a></h2>
<div class="userinfo">
פתח
<a>zacharya</a>
,
<time class="timeago relativetime" datetime="2014-06-17T15:21:31+03:00" style="display:inline-block;">
17 ליוני 2014 </time>
</div>
</div>
</div> <div class="clear"></div>
<div style="border-top:1px dashed #D1D1D1; margin-top:10px; padding-top:10px; " class="qnapost" id='questionText1934'>
יש לי קובץ PHP עם הקוד הבא:<br><div class="php codeblock"><span class="kw2">&lt;?php</span><br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-type: application/vnd.ms-word&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-Disposition: attachment;Filename=document_name.doc&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;html&gt;&quot;</span><span class="sy0">;</span><br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;meta http-equiv=<span class="es1">\&quot;</span>Content-Type<span class="es1">\&quot;</span> content=<span class="es1">\&quot;</span>text/html; charset=Windows-1252<span class="es1">\&quot;</span>&gt;&quot;</span><span class="sy0">;</span><br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;body&gt;&quot;</span><span class="sy0">;</span><br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;b&gt;My first document&lt;/b&gt;&quot;</span><span class="sy0">;</span><br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;/body&gt;&quot;</span><span class="sy0">;</span><br>
<span class="kw1">echo</span> <span class="st0">&quot;&lt;/html&gt;&quot;</span><span class="sy0">;</span><br>
<span class="sy1">?&gt;</span></div><br><br>עכשיו כשאני נכנס לתוך הקובץ הוא כמובן נותן לי הורדה למסמך הword שנבנה, אבל זה רק כאשר המשתמש ניגש לקובץ דרך הדפדפן, לעומת זאת אני מעוניין לקחת את המסמך word שנבנה ולא לתת למשתמש להוריד אותו אלה להכניס אותו לתוך קובץ zip (ziparchive class) ביחד עם עוד כמה דברים. </div>
</div>
<h3>
<span id="answersCounter">11 </span>
תשובות
</h3>
<section class="answers" id="qnaAnswers">
<div class="answer" id="answer8743">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8743" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8743">#</a>
</span>
<div class="clear"></div>
</div>
<p>
בקמקום לשלוח את הקובץ doc תייצר קובץ zip במקום ותשלח אותו.<br><br><div class="php codeblock"><span class="kw2">&lt;?php</span><br>
<br>
<span class="re0">$zip</span> <span class="sy0">=</span> <span class="kw2">new</span> ZipArchive<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<br>
&nbsp;<span class="kw1">if</span><span class="br0">&#40;</span><span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">open</span><span class="br0">&#40;</span><span class="st0">&quot;someName.zip&quot;</span><span class="sy0">,</span>ZIPARCHIVE<span class="sy0">::</span><span class="me2">CREATE</span><span class="br0">&#41;</span><span class="sy0">===</span><span class="kw4">TRUE</span><span class="br0">&#41;</span><br>
&nbsp;<span class="br0">&#123;</span><br>
&nbsp; &nbsp;<span class="co1">// הוספת קובץ לתוך הזיפ</span><br>
&nbsp; &nbsp;<span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">addFile</span><span class="br0">&#40;</span><span class="st0">&quot;document_name.doc&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
&nbsp; &nbsp;<br>
&nbsp; &nbsp;<span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
&nbsp; &nbsp;<span class="co1">// סגירת הזיפ</span><br>
&nbsp;<span class="br0">&#125;</span><br>
<br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-type: application/octet-stream&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> <br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-disposition: attachment; filename=someName.zip&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div><br><br><a href="..\צור קבצי zip עם php.htm">יצירת קבצי zip עם PHP</a><br><br>אם אתה צריך, קודם צור בנפרד את הקובץ word<br><br><div class="php codeblock"><span class="kw3">file_put_contents</span><span class="br0">&#40;</span><span class="st_h">'word.doc'</span><span class="sy0">,</span> <span class="st0">&quot;<br>
&nbsp; &lt;html&gt;<br>
&nbsp; &lt;meta http-equiv=<span class="es1">\&quot;</span>Content-Type<span class="es1">\&quot;</span> content=<span class="es1">\&quot;</span>text/html; charset=Windows-1252<span class="es1">\&quot;</span>&gt;<br>
&nbsp; &lt;body&gt;<br>
&nbsp; &lt;b&gt;My first document&lt;/b&gt;<br>
&nbsp; &lt;/body&gt;<br>
&nbsp; &lt;/html&gt;<br>
&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div> </p>
</div>
<div class="answer" id="answer8744">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8744" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8744">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אפשר לחסוך את הפעולה השניה ולעשות הכל ביחד:<br><br><div class="php codeblock"><span class="re0">$zip</span> <span class="sy0">=</span> <span class="kw2">new</span> ZipArchive<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<br>
&nbsp;<span class="kw1">if</span><span class="br0">&#40;</span><span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">open</span><span class="br0">&#40;</span><span class="st0">&quot;someName.zip&quot;</span><span class="sy0">,</span>ZIPARCHIVE<span class="sy0">::</span><span class="me2">CREATE</span><span class="br0">&#41;</span><span class="sy0">===</span><span class="kw4">TRUE</span><span class="br0">&#41;</span><br>
&nbsp;<span class="br0">&#123;</span><br>
&nbsp; &nbsp;<span class="co1">// הוספת קובץ לתוך הזיפ</span><br>
&nbsp; &nbsp;<span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">addFromString</span><span class="br0">&#40;</span><span class="st0">&quot;document_name.doc&quot;</span><span class="sy0">,</span> <span class="st0">&quot;<br>
&nbsp; &lt;html&gt;<br>
&nbsp; &lt;meta http-equiv=<span class="es1">\&quot;</span>Content-Type<span class="es1">\&quot;</span> content=<span class="es1">\&quot;</span>text/html; charset=Windows-1252<span class="es1">\&quot;</span>&gt;<br>
&nbsp; &lt;body&gt;<br>
&nbsp; &lt;b&gt;My first document&lt;/b&gt;<br>
&nbsp; &lt;/body&gt;<br>
&nbsp; &lt;/html&gt;<br>
&nbsp; &nbsp;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
&nbsp; &nbsp;<br>
&nbsp; &nbsp;<span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">close</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
&nbsp; &nbsp;<span class="co1">// סגירת הזיפ</span><br>
&nbsp;<span class="br0">&#125;</span><br>
<br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-type: application/octet-stream&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> <br>
<span class="kw3">header</span><span class="br0">&#40;</span><span class="st0">&quot;Content-disposition: attachment; filename=someName.zip&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div><br><br>אל תשכח למחוק את הקובץ שיווצר בסוף הסקריפט ולתת לקובץ שם רנדומלי כדי ששני משתמשים בבת אחת יוכלו להשתמש במערכת.<br>אפשר גם ללכת שלב אחד רחוק יותר ולהשתמש בספריית ZIP שלא שומרת קבצים בדיסק אלא בזיכרון בלבד. </p>
</div>
<div class="answer" id="answer8745">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/85d8ba5e8d11a29a5805a3e75ef024d6?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>zacharya</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8745" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8745">#</a>
</span>
<div class="clear"></div>
</div>
<p>
תודה :)<br>יש סיבה מסויימת שבגללה המחלקה ZipArchive לא עובדת בWAMP? </p>
</div>
<div class="answer" id="answer8746">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/85d8ba5e8d11a29a5805a3e75ef024d6?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>zacharya</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8746" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8746">#</a>
</span>
<div class="clear"></div>
</div>
<p>
לא חשוב, עובד. תודה רבה אלכס :) </p>
</div>
<div class="answer" id="answer8747">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/85d8ba5e8d11a29a5805a3e75ef024d6?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>zacharya</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8747" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8747">#</a>
</span>
<div class="clear"></div>
</div>
<p>
הוא עכשיו לצערי מחרבש לי שמות בעברית. נגיד יש לי קובץ &quot;מילים.doc&quot; הוא יוצר אותו בארכיון כ&quot;___??&amp;__.doc&quot; או משהו בסגנון (אך כל התוכן של הקובץ לא נפגע) </p>
</div>
<div class="answer" id="answer8748">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8748" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8748">#</a>
</span>
<div class="clear"></div>
</div>
<p>
כן. מחיפוש קצר בגוגל עולה שצריך לעשות המרת קידוד:<br><div class="php codeblock"><span class="re0">$name</span> <span class="sy0">=</span> <span class="st0">&quot;שם בעברית.doc&quot;</span><span class="sy0">;</span><br>
<br>
<span class="re0">$zip</span><span class="sy0">-&gt;</span><span class="me1">addFromString</span><span class="br0">&#40;</span><span class="kw3">iconv</span><span class="br0">&#40;</span><span class="st0">&quot;UTF-8&quot;</span><span class="sy0">,</span><span class="st0">&quot;CP862&quot;</span><span class="sy0">,</span><span class="re0">$name</span><span class="br0">&#41;</span><span class="sy0">,</span> <span class="st0">&quot;<br>
&nbsp; &lt;html&gt;<br>
&nbsp; &lt;meta http-equiv=<span class="es1">\&quot;</span>Content-Type<span class="es1">\&quot;</span> content=<span class="es1">\&quot;</span>text/html; charset=Windows-1252<span class="es1">\&quot;</span>&gt;<br>
&nbsp; &lt;body&gt;<br>
&nbsp; &lt;b&gt;My first document&lt;/b&gt;<br>
&nbsp; &lt;/body&gt;<br>
&nbsp; &lt;/html&gt;<br>
&nbsp; &nbsp;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span></div> </p>
</div>
<div class="answer" id="answer8749">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/7879b706e45bf4406cf3f246538d767f?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>OrelBeY</a>
ב
<span style="font-size:10px"> 17 ליוני 2014 </span>
<a id="answer_8749" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8749">#</a>
</span>
<div class="clear"></div>
</div>
<p>
קח בחשבון שזו רק דרך לעקוף את זה, אבל <a href="https://bugs.php.net/bug.php?id=53948">הבעיה היא לא אצלך</a>. בגרסת zip 1.11.0 (מ-PECL) <a href="http://pecl.php.net/package-info.php?package=zip&amp;version=1.11.0">תוקנה הבעיה עם קידוד UTF-8</a>. </p>
</div>
<div class="answer" id="answer8760">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/85d8ba5e8d11a29a5805a3e75ef024d6?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>zacharya</a>
ב
<span style="font-size:10px"> 18 ליוני 2014 </span>
<a id="answer_8760" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8760">#</a>
</span>
<div class="clear"></div>
</div>
<p>
ניסיתי כבר את ההמרת קידוד לפני ששאלתי וזה לא עבד ): </p>
</div>
<div class="answer" id="answer8762">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/7879b706e45bf4406cf3f246538d767f?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>OrelBeY</a>
ב
<span style="font-size:10px"> 19 ליוני 2014 </span>
<a id="answer_8762" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8762">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אבל ניסית להמיר מ-UTF-8 ל-CP862? </p>
</div>
<div class="answer" id="answer8771">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/85d8ba5e8d11a29a5805a3e75ef024d6?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>zacharya</a>
ב
<span style="font-size:10px"> 22 ליוני 2014 </span>
<a id="answer_8771" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8771">#</a>
</span>
<div class="clear"></div>
</div>
<p>
כן </p>
</div>
<div class="answer" id="answer8773">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 22 ליוני 2014 </span>
<a id="answer_8773" href="שמירת קובץ עם Header מותאם אישית בPHP.htm#answer_8773">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אם יש לך אפשרות - עדכן את ספריית ה zip<br>אם לא, נסה להשתמש בספרייה אחרת </p>
</div>
</section>
</section>  
<section id="sidebar">
<section id="search_box">
<form method="get" action="http://www.google.co.il/search" id="search_form">
<input type="hidden" name="hl" value="iw">
<input type="checkbox" name="sitesearch" style="display:none" value="http://phpguide.co.il" checked="">
<input type="text" class="search_form" placeholder="חיפוש" name="q" id="search_field">
<input type="submit" value="" title="לחפש">
</form>
</section>
<style>.staticSidebarPageLinks a{color:#e85a2d;font-weight:bold;text-decoration:underline}</style>
<div class='rblock staticSidebarPageLinks' style="padding:0 -50px; width:100%; background: white;">
<a href="page_mvcebook.html" title="למד איך עובד MVC" onclick="Analytics.track('Promotion', 'click', 'GoToLanding', 'mvcebook-sidebar-banner1');">
ספר חינם על MVC
</a>
שאתה הולך להוריד כי אם אתה רוצה ללמוד על ארגון קוד יעיל ומודרני באתרים כמו זה או פייסבוק או כי כולם אוהבים להוריד דברים איכותיים בחינם מהאינטרנט
<br><br>
<a href='page_oopbook.html'>
ספר הלימוד - תכנות מונחה עצמים מאפס
</a>
שסוף סוף ילמד אותך פיתוח מונחה עצמים נכון בצורה פשוטה, יענה על כל השאלות ויכין אותך לרעיונות עבודה.
<br><br>
<a href='page_phpunit.html'>
קורס בדיקות יחידה phpunit
</a>
שיעזור לך להקטין בחצי את כמות הבאגים, את כאב הראש והזמן המבוזבז על פתירתם
<br><br>
<a href='page_mysqlinteractive.html'>
קורס mysql אינטרקטיבי
</a>
שיייקח אותך צעד אחר צעד למומחה שאילתות mysql לייב
<br><br><br>
<small>האתר ב-readonly
<br>
תודה לכל מי שתרם, ענה, שאל, כתב, לימד ועזר במשך השנים <br>
orelbey, splash, raslin, cayce, iiddaannyy, michael, kingyes, ilikeme, itamarhadad, iosolidar, jbstyle<br>
- alex@הדומיין הזה
</small>
</div>
</section>
</div>
<footer id='footer'>
</footer>
</div>  
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-resource.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-cookies.min.js"></script>
<script type="text/javascript" src="..\assets\c2224fc8\jquery.min.js.pagespeed.jm.0IhQ85x_cu.js"></script>
<script src="..\static\scripts\scripts.compiled.js plugins.js ui.js analytics.js.pagespeed.jc.HoDAx8MSoV.js"></script><script>eval(mod_pagespeed_suqc1br1Uj);</script>
<script>eval(mod_pagespeed_tNeKvp6lmR);</script>
<script>eval(mod_pagespeed_PxPJYmoXjB);</script>
<script>eval(mod_pagespeed_2G0hMgPcln);</script>
</body>
</html>
