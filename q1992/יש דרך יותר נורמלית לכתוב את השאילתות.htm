<!DOCTYPE html>
<html lang="he" itemscope="" itemtype="http://schema.org/Blog" ng-app="phpg">
<head>
<base href="http://phpguide.co.il/">
<meta charset="utf-8">
<meta name="description" content="שאלה יש דרך יותר נורמלית לכתוב את השאילתות?">
<meta name="keywords" content="שאלה, עזרה">
<meta name="author" content="undefined ">
<link rel="shortcut icon" href="..\static\images\favicon.ico">
<!--[if lt IE 9]><script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="..\static\styles\A.allstyles.compiled.css.pagespeed.cf.P4R8BwzxFu.css">
<title>יש דרך יותר נורמלית לכתוב את השאילתות? | שאלת לימוד PHP</title>
<meta itemprop="name" content="יש דרך יותר נורמלית לכתוב את השאילתות? | שאלת לימוד PHP">
<meta itemprop="description" content="שאלה יש דרך יותר נורמלית לכתוב את השאילתות?">
</head>
<body dir='rtl' class="forum-qna">
<div class='page-container'>
<section id='header'>
<div class="topRowHolder">
<a class="logo" href="..\index.htm"><img src="..\static\images\xlogo.jpg.pagespeed.ic.6YgiLES4FJ.jpg"></a>
<nav class="main">
<ul>
<li><a href="..\index.htm">פוסטים</a></li>
<li><a href="..\qna.htm" class="active">פורום</a></li>
</ul>
<div class="clear"></div>
</nav> <div class="clear"></div>
</div>
</section>  
<div class="layout-holder">
<section id="content">
<div class="qna_view_question" id="qnaQuestionHolder">
<div class="qna-home-row">
<div class="counts">
 
<div class="status  answered">
<div class="item-count">8</div>
<div>
תגובות
</div>
</div>
</div>
<div class="question-summary-wrapper">
<h2><a href="יש דרך יותר נורמלית לכתוב את השאילתות.htm" title="היי,אני מפתח אתר ובאתר יש סטטיסטיקות, הכוונה לכזה דבר: http://i.imgur.com/zp6TJ3u.png .ובקוד עצמו, לדוגמה החלק שמציג את מספר הרשומים נראה כך:http://prntscr.com/4gd06n .וזה עובד סבבה. השאלה היא האם כל פעם שארצה לעשות שאילתא אצטרך לעשות את הif הזה? אין דרך אחרת? כי הקוד סתם יצא ארוך, לדוגמה ככה: http://prntscr.com/4gd29f .תודה מראש לעונים :)">יש דרך יותר נורמלית לכתוב את השאילתות?</a></h2>
<div class="userinfo">
פתח
<a>undefined </a>
,
<time class="timeago relativetime" datetime="2014-08-25T17:55:27+03:00" style="display:inline-block;">
25 לאוגוסט 2014 </time>
</div>
</div>
</div> <div class="clear"></div>
<div style="border-top:1px dashed #D1D1D1; margin-top:10px; padding-top:10px; " class="qnapost" id='questionText1992'>
היי,<br>אני מפתח אתר ובאתר יש סטטיסטיקות, הכוונה לכזה דבר: <br>http://i.imgur.com/zp6TJ3u.png .<br><br>ובקוד עצמו, לדוגמה החלק שמציג את מספר הרשומים נראה כך:<br>http://prntscr.com/4gd06n .<br><br>וזה עובד סבבה. השאלה היא האם כל פעם שארצה לעשות שאילתא אצטרך לעשות את הif הזה? אין דרך אחרת? כי הקוד סתם יצא ארוך, לדוגמה ככה: http://prntscr.com/4gd29f .<br><br>תודה מראש לעונים :) </div>
</div>
<h3>
<span id="answersCounter">8 </span>
תשובות
</h3>
<section class="answers" id="qnaAnswers">
<div class="answer" id="answer8987">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 25 לאוגוסט 2014 </span>
<a id="answer_8987" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_8987">#</a>
</span>
<div class="clear"></div>
</div>
<p>
א. במקום לשלוף את כל השורות ואז להתעלם מהם ופשוט לקחת את num_rows אפשר לבקש מהמסד לא לקרוא את הנתונים, אלא רק לספור<br>ב. אפשר לחבר כמה שאילתות לאחת באמצעות הפקודה UNION<br><br>מה שיצא ייראה ככה:<br><div class="php codeblock">select <span class="kw3">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> from users <br>
UNION<br>
select <span class="kw3">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> from users where blocked <span class="sy0">=</span> <span class="nu0">1</span><br>
UNION<br>
select <span class="kw3">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> from users where x <span class="sy0">=</span> y</div><br>התוצאה של השליפה תהיה שלוש שורות כשבכל שורה שדה אחד שהוא מספר. תריץ אותה ותראה מה יוצא </p>
</div>
<div class="answer" id="answer8988">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/9c311d265f51357a6643515b77157b4c?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>undefined </a>
ב
<span style="font-size:10px"> 25 לאוגוסט 2014 </span>
<a id="answer_8988" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_8988">#</a>
</span>
<div class="clear"></div>
</div>
<p>
תודה על המענה, בנוגע לא&apos; זה בהחלט נשמע יותר הגיוני ויעיל, חידשת לי, אך בכל זאת אם האופציה הזאת של count קיימת, למה יש פונקציית num_rows?<br>בנוגע ל2, הרצתי וקיבלתי 3 שורות, בכל שורה מספר אחר (בהתאם לטבלה עליה עשיתי count), איך עובדים עם המידע הזה בphp? הרי זו שאילתא אחת שנמצאת במשתנה אחד, יש דרך לגשת אליה ולקבל כל פעם נתון אחר? אולי כמו במערך (שכל שורה היא אינדקס אחר)? עשיתי את זה בינתיים:<br>http://prntscr.com/4gfosd .<br><br>אך מה לרשום בתוך המשתנה statics? הרי השליפה היא של מספר השורות בטבלה, לא של ערכים מעמודות מסוימות.<br><br>עריכה:<br>חיפשתי קצת בגוגל ומצאתי שצריך לאחר הcount לעשות alias, ואת מה שכתבתי בalias לכתוב בתוך statics. אך זה מציג מספר השורות של כל העמודות ביחד, לא רק של users, הינה השאילתא:<br><div class="php codeblock">SELECT <span class="kw3">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">as</span> users_total FROM users UNION SELECT <span class="kw3">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">as</span> status_total FROM rstatus</div><br><br>עריכה שניה:<br>חיפשתי שוב בגוגל והגעתי כמו מקודם לstackoverflow, שם מצאתי את התשובה, והיא sub queires.<br>הקוד נראה עכשיו ככה:<br>http://prntscr.com/4ggcxd .<br><br>והוא עובד טוב, אך הוא יעיל? היית משנה בו משהו כדי לעשות אותו יותר טוב?<br>תודה מראש :) </p>
</div>
<div class="answer" id="answer8989">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 26 לאוגוסט 2014 </span>
<a id="answer_8989" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_8989">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אתה לא ממש צריך alias<br>אפשר לעבוד אם התוצאה בדיוק כפי שאתה עובד עם כל תוצאה אחרת בת כמה שורות שמוחזרת מהמסד<br>אפילו לא צריך לולאלות:<br><br><div class="php codeblock"><span class="re0">$query</span> <span class="sy0">=</span> <span class="st0">&quot;select count(*) from users <br>
UNION<br>
select count(*) from users where blocked = 1<br>
UNION<br>
select count(*) from users where x = y&quot;</span><span class="sy0">;</span><br>
<br>
<span class="re0">$result</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">&#40;</span><span class="re0">$query</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<span class="re0">$stats</span> <span class="sy0">=</span> <span class="re0">$result</span><span class="sy0">-&gt;</span><span class="me1">fetchAll</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br>
<br>
<span class="kw3">var_dump</span><span class="br0">&#40;</span><span class="re0">$stats</span><span class="br0">&#41;</span><span class="sy0">;</span></div><br><br>אתה עשית אותו דבר, רק עם לולאה ומשהו מוזר בסגנון echo array. לא נראה לי שאפשר לעשות ככה echo לאלמנט במערך בלי אינדקס </p>
</div>
<div class="answer" id="answer8990">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/9c311d265f51357a6643515b77157b4c?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>undefined </a>
ב
<span style="font-size:10px"> 26 לאוגוסט 2014 </span>
<a id="answer_8990" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_8990">#</a>
</span>
<div class="clear"></div>
</div>
<p>
כדי להציג את הנתונים צריך בסופו של דבר לעשות לולאה (foreach) אם הולכים לפי הדרך שנתת, אך בכל זאת בהדפסה מה שמודפס הוא כל השורות ולא רק השורה שאני מעוניין בה (לדוגמה echo stats 0 כאשר 0 הוא האינדקס של השורה הראשונה מחזיר את כל השורות).<br><br>יש לך רעיון? </p>
</div>
<div class="answer" id="answer8993">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/9c311d265f51357a6643515b77157b4c?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>undefined </a>
ב
<span style="font-size:10px"> 27 לאוגוסט 2014 </span>
<a id="answer_8993" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_8993">#</a>
</span>
<div class="clear"></div>
</div>
<p>
הקפצה, מישהו פתח הרבה אשכולות. </p>
</div>
<div class="answer" id="answer9004">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 31 לאוגוסט 2014 </span>
<a id="answer_9004" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_9004">#</a>
</span>
<div class="clear"></div>
</div>
<p>
לא הבנתי את השאלה. <br>התואצה של הפונקציה fetch_all היא מערך רב מימדי. אתה שואל איך לגשת אל נתונים בתוכו?<br><div class="php codeblock"><span class="kw1">echo</span> <span class="re0">$stats</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="co1">// count * from users</span><br>
<span class="kw1">echo</span> <span class="re0">$stats</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="co1">// select count(*) from users where blocked = 1</span><br>
<span class="kw1">echo</span> <span class="re0">$stats</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="co1">// select count(*) from users where x = y&quot;;</span></div> </p>
</div>
<div class="answer" id="answer9009">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/9c311d265f51357a6643515b77157b4c?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>undefined </a>
ב
<span style="font-size:10px"> 01 לספטמבר 2014 </span>
<a id="answer_9009" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_9009">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אוקיי הבנתי והצלחתי, ככה עכשיו זה נראה: http://prntscr.com/4imhz0 .<br>מה שהיה קודם נמצא בתוך ההערות.<br>אך מה יותר יעיל? </p>
</div>
<div class="answer" id="answer9011">
<div>
<span class="userinfo">
<img class="avatar" src="http://www.gravatar.com/avatar/29c688bfdc6cb0d2e6dea24ccdc7beb1?s=20&amp;r=g&amp;d=monsterid" alt="avatar"> ענה
<a>intval</a>
ב
<span style="font-size:10px"> 01 לספטמבר 2014 </span>
<a id="answer_9011" href="יש דרך יותר נורמלית לכתוב את השאילתות.htm#answer_9011">#</a>
</span>
<div class="clear"></div>
</div>
<p>
אותו דבר </p>
</div>
</section>
</section>  
<section id="sidebar">
<section id="search_box">
<form method="get" action="http://www.google.co.il/search" id="search_form">
<input type="hidden" name="hl" value="iw">
<input type="checkbox" name="sitesearch" style="display:none" value="http://phpguide.co.il" checked="">
<input type="text" class="search_form" placeholder="חיפוש" name="q" id="search_field">
<input type="submit" value="" title="לחפש">
</form>
</section>
<style>.staticSidebarPageLinks a{color:#e85a2d;font-weight:bold;text-decoration:underline}</style>
<div class='rblock staticSidebarPageLinks' style="padding:0 -50px; width:100%; background: white;">
<a href="page_mvcebook.html" title="למד איך עובד MVC" onclick="Analytics.track('Promotion', 'click', 'GoToLanding', 'mvcebook-sidebar-banner1');">
ספר חינם על MVC
</a>
שאתה הולך להוריד כי אם אתה רוצה ללמוד על ארגון קוד יעיל ומודרני באתרים כמו זה או פייסבוק או כי כולם אוהבים להוריד דברים איכותיים בחינם מהאינטרנט
<br><br>
<a href='page_oopbook.html'>
ספר הלימוד - תכנות מונחה עצמים מאפס
</a>
שסוף סוף ילמד אותך פיתוח מונחה עצמים נכון בצורה פשוטה, יענה על כל השאלות ויכין אותך לרעיונות עבודה.
<br><br>
<a href='page_phpunit.html'>
קורס בדיקות יחידה phpunit
</a>
שיעזור לך להקטין בחצי את כמות הבאגים, את כאב הראש והזמן המבוזבז על פתירתם
<br><br>
<a href='page_mysqlinteractive.html'>
קורס mysql אינטרקטיבי
</a>
שיייקח אותך צעד אחר צעד למומחה שאילתות mysql לייב
<br><br><br>
<small>האתר ב-readonly
<br>
תודה לכל מי שתרם, ענה, שאל, כתב, לימד ועזר במשך השנים <br>
orelbey, splash, raslin, cayce, iiddaannyy, michael, kingyes, ilikeme, itamarhadad, iosolidar, jbstyle<br>
- alex@הדומיין הזה
</small>
</div>
</section>
</div>
<footer id='footer'>
</footer>
</div>  
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-resource.min.js"></script>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.6/angular-cookies.min.js"></script>
<script type="text/javascript" src="..\assets\c2224fc8\jquery.min.js.pagespeed.jm.0IhQ85x_cu.js"></script>
<script src="..\static\scripts\scripts.compiled.js plugins.js ui.js analytics.js.pagespeed.jc.HoDAx8MSoV.js"></script><script>eval(mod_pagespeed_suqc1br1Uj);</script>
<script>eval(mod_pagespeed_tNeKvp6lmR);</script>
<script>eval(mod_pagespeed_PxPJYmoXjB);</script>
<script>eval(mod_pagespeed_2G0hMgPcln);</script>
</body>
</html>
