<head/><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php&nbsp;
<br/>set_error_handler</span><span style="color: #007700">(</span><span style="color: #DD0000">'handleTypehint'</span><span style="color: #007700">);<br/><br/><br/></span><span style="color: #0000BB">$s</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br/>function&nbsp;</span><span style="color: #0000BB">a</span><span style="color: #007700">(</span><span style="color: #0000BB">int&nbsp;$b</span><span style="color: #007700">){};<br/><br/>for(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">1000</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)<br/></span><span style="color: #0000BB">a</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;works<br/></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">)-</span><span style="color: #0000BB">$s</span><span style="color: #007700">;<br/><br/>echo&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br/><br/></span><span style="color: #0000BB">$z&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DateTime</span><span style="color: #007700">(</span><span style="color: #DD0000">'now'</span><span style="color: #007700">);<br/><br/></span><span style="color: #0000BB">$s</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br/>function&nbsp;</span><span style="color: #0000BB">b</span><span style="color: #007700">(</span><span style="color: #0000BB">DateTime&nbsp;$b</span><span style="color: #007700">){};<br/><br/>for(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">1000</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)<br/></span><span style="color: #0000BB">b</span><span style="color: #007700">(</span><span style="color: #0000BB">$z</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;works<br/></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">)-</span><span style="color: #0000BB">$s</span><span style="color: #007700">;<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></span><span style="color: #FF8000">//&nbsp;handleTypeHintIsBelow&nbsp;&nbsp;v<br/><br/><br/><br/><br/><br/></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">handleTypehint</span><span style="color: #007700">(</span><span style="color: #0000BB">$errorLevel</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errorMessage</span><span style="color: #007700">)<br/>{<br/>&nbsp;&nbsp;&nbsp;&nbsp;static&nbsp;</span><span style="color: #0000BB">$map&nbsp;</span><span style="color: #007700">=&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;[<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'int'&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'integer'</span><span style="color: #007700">,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'bool'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'boolean'</span><span style="color: #007700">,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'str'&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'string'<br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">];<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;handle&nbsp;only&nbsp;recoverable&nbsp;errors<br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$errorLevel&nbsp;</span><span style="color: #007700">!==&nbsp;</span><span style="color: #0000BB">E_RECOVERABLE_ERROR</span><span style="color: #007700">)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Check&nbsp;this&nbsp;is&nbsp;the&nbsp;right&nbsp;error&nbsp;message&nbsp;we&nbsp;are&nbsp;trying&nbsp;to&nbsp;handle<br/>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^Argument&nbsp;(\d)+&nbsp;passed&nbsp;to&nbsp;(?:(\w+)::)?(\w+)\(\)&nbsp;must&nbsp;be&nbsp;an&nbsp;instance&nbsp;of&nbsp;(\w+),&nbsp;(\w+)&nbsp;given/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$errorMessage</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$match</span><span style="color: #007700">))&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$expectedType&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$match</span><span style="color: #007700">[</span><span style="color: #0000BB">4</span><span style="color: #007700">];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$givenType&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$match</span><span style="color: #007700">[</span><span style="color: #0000BB">5</span><span style="color: #007700">];<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$expectedType&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">$givenType&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$map</span><span style="color: #007700">[</span><span style="color: #0000BB">$expectedType</span><span style="color: #007700">]&nbsp;===&nbsp;</span><span style="color: #0000BB">$givenType</span><span style="color: #007700">)&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;&nbsp;<br/>}</span>
</span>
</code>1