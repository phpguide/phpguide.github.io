<head/><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php&nbsp;
<br/>$userid&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">;<br/></span><span style="color: #0000BB">$somesecret&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'abcabcab'</span><span style="color: #007700">;<br/><br/></span><span style="color: #0000BB">$validCookie&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$userid&nbsp;</span><span style="color: #007700">.</span><span style="color: #DD0000">'-'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'sha256'</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #0000BB">$userid&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$somesecret</span><span style="color: #007700">);<br/></span><span style="color: #FF8000">//&nbsp;echo&nbsp;'validCookie&nbsp;',&nbsp;$validCookie;<br/>//&nbsp;validCookie&nbsp;10-dbdb4d162c56a34202281c492acb566add07e5949c7ff3ffcd27474235556052<br/><br/>//&nbsp;you&nbsp;do&nbsp;the&nbsp;setCookie&nbsp;stufff<br/><br/>//&nbsp;NOW&nbsp;COOL&nbsp;HACKER&nbsp;COMES&nbsp;AND&nbsp;CHANGES&nbsp;THE&nbsp;id&nbsp;to&nbsp;55555555<br/>//&nbsp;his&nbsp;new&nbsp;cookie&nbsp;will&nbsp;be<br/>//&nbsp;5555555555-dbdb4d162c56a34202281c492acb566add07e5949c7ff3ffcd27474235556052<br/>//&nbsp;he&nbsp;doesnt&nbsp;know&nbsp;your&nbsp;somesecret<br/><br/>//&nbsp;now&nbsp;he&nbsp;visits&nbsp;your&nbsp;site&nbsp;with&nbsp;this&nbsp;cookie<br/>//&nbsp;you&nbsp;validate&nbsp;it<br/><br/></span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'test'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'5555555555-dbdb4d162c56a34202281c492acb566add07e5949c7ff3ffcd27474235556052'</span><span style="color: #007700">;<br/><br/>list(</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$hash</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">'-'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">'test'</span><span style="color: #007700">]);<br/>echo&nbsp;</span><span style="color: #DD0000">'hello&nbsp;user&nbsp;id&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">;<br/><br/></span><span style="color: #0000BB">$expectedHash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'sha256'</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$somesecret</span><span style="color: #007700">);<br/><br/></span><span style="color: #FF8000">//&nbsp;the&nbsp;real&nbsp;check<br/></span><span style="color: #007700">if(&nbsp;</span><span style="color: #0000BB">$hash&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">$expectedHash&nbsp;</span><span style="color: #007700">)&nbsp;echo&nbsp;</span><span style="color: #DD0000">'&nbsp;you&nbsp;are&nbsp;real'</span><span style="color: #007700">;<br/>else&nbsp;echo&nbsp;</span><span style="color: #DD0000">',&nbsp;but&nbsp;you&nbsp;are&nbsp;a&nbsp;hacker'</span><span style="color: #007700">;<br/><br/></span><span style="color: #FF8000">//now&nbsp;run&nbsp;this&nbsp;code</span>
</span>
</code>1