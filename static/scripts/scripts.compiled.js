(function(){window.phpgAngularModule=window.phpgAngularModule||angular.module("phpg",["ngResource"],function($httpProvider){$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";$httpProvider.defaults.headers.post["X-Requested-With"]="XMLHttpRequest";return $httpProvider.defaults.transformRequest=[function(data){var param;param=function(obj){var fullSubName,i,innerObj,name,query,subName,subValue,value;query="";name=void 0;value=void 0;fullSubName=void 0;subName=void 0;subValue=void 0;innerObj=void 0;i=void 0;for(name in obj){value=obj[name];if(value instanceof Array){i=0;while(i<value.length){subValue=value[i];fullSubName=name+"["+i+"]";innerObj={};innerObj[fullSubName]=subValue;query+=param(innerObj)+"&";++i;}}else if(value instanceof Object){for(subName in value){subValue=value[subName];fullSubName=name+"["+subName+"]";innerObj={};innerObj[fullSubName]=subValue;query+=param(innerObj)+"&";}}else{if(value!==undefined&&value!==null){query+=encodeURIComponent(name)+"="+encodeURIComponent(value)+"&";}}}
if(query.length){return query.substr(0,query.length-1);}else{return query;}};if(angular.isObject(data)&&String(data)!=="[object File]"){return param(data);}else{return data;}}];});window.phpgAngularModule.factory("phpgstate",['$window',function(win){return win['phpgstate'];}]);}).call(this);(function(){phpgAngularModule.controller("PostViewCtrl",['$scope','$http','phpgstate',function($scope,$http,phpgstate){$scope.hasAlreadyVoted=phpgstate.post.hasCurrentUserVoted;$scope.postRating=phpgstate.post.rating;return $scope.vote=function(direction){var rating;if($scope.hasAlreadyVoted){return;}
if(direction==='down'){rating=-1;}else{rating=1;}
return $http.post("posts/changeRating/"+phpgstate.post.id,{score:rating}).success(function(data){$scope.postRating=data;return $scope.hasAlreadyVoted=true;});};}]);}).call(this);